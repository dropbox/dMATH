{
  "id": "dafny",
  "name": "Dafny",
  "category": "program_verification",
  "subcategory": "deductive_verification",

  "description": "Verification-aware programming language with built-in specification constructs",
  "long_description": "Dafny is a verification-aware programming language that includes built-in specification constructs. The Dafny verifier proves that programs satisfy their specifications using Boogie and Z3. It supports pre/postconditions, loop invariants, termination metrics, and refinement. Programs can compile to C#, Java, JavaScript, Go, and Python.",

  "capabilities": [
    "deductive_verification",
    "precondition_verification",
    "postcondition_verification",
    "loop_invariant_checking",
    "termination_checking",
    "ghost_code",
    "refinement_types",
    "lemma_proofs",
    "code_generation"
  ],
  "property_types": ["requires", "ensures", "invariant", "decreases", "lemma"],
  "input_languages": ["dafny"],
  "output_formats": ["verification_result", "csharp", "java", "javascript", "go", "python"],

  "installation": {
    "methods": [
      {"type": "dotnet", "command": "dotnet tool install --global dafny"},
      {"type": "vscode", "extension": "dafny-lang.ide-vscode"},
      {"type": "brew", "command": "brew install dafny"}
    ],
    "dependencies": ["dotnet-sdk", "z3"],
    "platforms": ["linux", "macos", "windows"]
  },

  "documentation": {
    "official": "https://dafny.org/",
    "tutorial": "https://dafny.org/dafny/OnlineTutorial/guide",
    "api_reference": "https://dafny.org/dafny/DafnyRef/DafnyRef",
    "examples": "https://github.com/dafny-lang/dafny/tree/master/Test"
  },

  "tactics": [
    {
      "name": "verify",
      "description": "Verify program specifications",
      "syntax": "dafny verify file.dfy",
      "when_to_use": "Checking that code satisfies specifications",
      "examples": ["dafny verify program.dfy", "dafny verify --boogie-opt:/proverOpt:O:smt.arith.nl=false file.dfy"]
    },
    {
      "name": "build",
      "description": "Compile to target language",
      "syntax": "dafny build --target:lang file.dfy",
      "when_to_use": "Generating executable code",
      "examples": ["dafny build --target:cs program.dfy", "dafny build --target:py program.dfy"]
    },
    {
      "name": "requires",
      "description": "Specify precondition",
      "syntax": "requires condition",
      "when_to_use": "Constraining method inputs",
      "examples": ["requires x > 0", "requires forall i :: 0 <= i < |a| ==> a[i] >= 0"]
    },
    {
      "name": "ensures",
      "description": "Specify postcondition",
      "syntax": "ensures condition",
      "when_to_use": "Specifying method guarantees",
      "examples": ["ensures result >= 0", "ensures |result| == |input|"]
    },
    {
      "name": "invariant",
      "description": "Specify loop invariant",
      "syntax": "invariant condition",
      "when_to_use": "Proving loop correctness",
      "examples": ["invariant 0 <= i <= n", "invariant sum == i * (i-1) / 2"]
    },
    {
      "name": "decreases",
      "description": "Specify termination metric",
      "syntax": "decreases expression",
      "when_to_use": "Proving termination",
      "examples": ["decreases n - i", "decreases |set|"]
    }
  ],

  "error_patterns": [
    {
      "pattern": "postcondition might not hold",
      "meaning": "Cannot prove ensures clause",
      "common_causes": ["Missing invariant", "Incorrect specification", "Bug in code"],
      "fixes": ["Add loop invariant", "Strengthen preconditions", "Fix implementation"]
    },
    {
      "pattern": "assertion might not hold",
      "meaning": "Assertion cannot be proven",
      "common_causes": ["Missing lemma", "Insufficient context"],
      "fixes": ["Add intermediate assertions", "Prove lemma", "Add requires clause"]
    },
    {
      "pattern": "cannot prove termination",
      "meaning": "Decreases clause not proven",
      "common_causes": ["Missing decreases", "Non-terminating loop"],
      "fixes": ["Add decreases clause", "Prove variant decreases"]
    },
    {
      "pattern": "precondition might not hold",
      "meaning": "Call site doesn't satisfy requires",
      "common_causes": ["Missing checks", "Incorrect caller assumptions"],
      "fixes": ["Add checks before call", "Strengthen caller's preconditions"]
    }
  ],

  "integration": {
    "dashprove_backend": true,
    "usl_property_types": ["contract", "invariant", "theorem"],
    "cli_command": "dashprove verify --backend dafny"
  },

  "performance": {
    "typical_runtime": "Seconds to minutes per method",
    "scalability": "Linear in code size, exponential in specification complexity",
    "memory_usage": "Moderate (Z3 solver)"
  },

  "comparisons": {
    "similar_tools": ["frama-c", "spark", "verus", "prusti"],
    "advantages": [
      "Integrated verification and programming",
      "Multi-language code generation",
      "Excellent documentation and tooling",
      "Active development and community"
    ],
    "disadvantages": [
      "Learning curve for specification",
      "Verification can be slow for complex code",
      "Not directly usable with existing codebases"
    ]
  },

  "metadata": {
    "version": "4.4.0",
    "last_updated": "2025-12-20",
    "maintainer": "Microsoft Research / Amazon",
    "license": "MIT"
  }
}
