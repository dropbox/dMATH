{
  "tool": "netstat",
  "version": "net-tools",
  "last_updated": "2025-12-23",
  "errors": [
    {
      "id": "command_not_found",
      "pattern": "netstat: command not found",
      "message": "net-tools not installed",
      "cause": "Package not installed on modern systems",
      "solutions": [
        {
          "approach": "Install net-tools",
          "code": "sudo apt install net-tools  # Debian\nsudo yum install net-tools  # RHEL",
          "when": "Install legacy tools"
        },
        {
          "approach": "Use ss instead",
          "code": "# Modern equivalents:\nss -tuln           # netstat -tuln\nss -tulnp          # netstat -tulnp\nss -s              # netstat -s (stats)",
          "when": "Recommended"
        }
      ]
    },
    {
      "id": "permission_denied",
      "pattern": "Permission denied|not permitted|can't identify process",
      "message": "Cannot show process info",
      "cause": "Need root to see all process names",
      "solutions": [
        {
          "approach": "Use sudo",
          "code": "sudo netstat -tulnp",
          "when": "See all process names"
        }
      ]
    },
    {
      "id": "deprecated_warning",
      "pattern": "DEPRECATED|obsolete|warning.*ss",
      "message": "Command deprecated",
      "cause": "netstat being replaced by ss",
      "solutions": [
        {
          "approach": "Learn ss",
          "code": "ss -t      # TCP connections\nss -u      # UDP\nss -l      # Listening\nss -n      # Numeric\nss -p      # Process info\nss -a      # All sockets",
          "when": "Modern alternative"
        },
        {
          "approach": "Equivalents",
          "code": "# netstat -tulnp → ss -tulnp\n# netstat -an → ss -an\n# netstat -r → ip route\n# netstat -i → ip -s link",
          "when": "Reference"
        }
      ]
    },
    {
      "id": "output_interpretation",
      "pattern": "LISTEN|ESTABLISHED|TIME_WAIT|CLOSE_WAIT",
      "message": "Understanding states",
      "cause": "TCP connection states",
      "solutions": [
        {
          "approach": "Common states",
          "code": "# LISTEN - Waiting for connections\n# ESTABLISHED - Active connection\n# TIME_WAIT - Recently closed (normal)\n# CLOSE_WAIT - Waiting for app to close\n# SYN_SENT/SYN_RECV - Handshake in progress",
          "when": "State reference"
        },
        {
          "approach": "Filter by state",
          "code": "netstat -an | grep ESTABLISHED\nss state established",
          "when": "Filter output"
        }
      ]
    },
    {
      "id": "routing_table",
      "pattern": "routing|route|gateway",
      "message": "View routing table",
      "cause": "Need routing information",
      "solutions": [
        {
          "approach": "Show routes",
          "code": "netstat -rn\nnetstat -r",
          "when": "View routing"
        },
        {
          "approach": "Modern alternative",
          "code": "ip route show\nip r",
          "when": "Use ip command"
        }
      ]
    }
  ]
}
