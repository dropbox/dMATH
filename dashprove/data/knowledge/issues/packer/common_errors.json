{
  "tool": "packer",
  "category": "image_building",
  "description": "HashiCorp Packer - machine image building automation",
  "common_errors": [
    {
      "id": "builder_error",
      "pattern": "Builder error",
      "regex": "(?i)builder.*error|build.*failed|amazon-ebs.*error|vmware.*error",
      "cause": "Error in the builder (AWS, VMware, etc.) during image creation",
      "solution": "Check cloud credentials, verify AMI/image source exists, review builder-specific configuration",
      "severity": "high",
      "category": "builder"
    },
    {
      "id": "provisioner_failed",
      "pattern": "Provisioner failed",
      "regex": "(?i)provisioner.*failed|shell.*error|ansible.*failed|script.*error",
      "cause": "Provisioning script or tool failed during image build",
      "solution": "Check script syntax, verify file paths, review provisioner logs, test scripts manually",
      "severity": "high",
      "category": "provisioner"
    },
    {
      "id": "ssh_connection_failed",
      "pattern": "SSH connection failed",
      "regex": "(?i)ssh.*connection.*failed|ssh.*timeout|ssh.*handshake|communicator.*error",
      "cause": "Unable to establish SSH connection to build instance",
      "solution": "Check security group allows SSH, verify SSH key/password, increase ssh_timeout",
      "severity": "high",
      "category": "communicator"
    },
    {
      "id": "winrm_connection_failed",
      "pattern": "WinRM connection failed",
      "regex": "(?i)winrm.*connection|winrm.*failed|winrm.*timeout",
      "cause": "Unable to establish WinRM connection to Windows build instance",
      "solution": "Verify WinRM is enabled, check firewall rules for ports 5985/5986, configure winrm_user/password",
      "severity": "high",
      "category": "communicator"
    },
    {
      "id": "cloud_auth_error",
      "pattern": "authentication failed",
      "regex": "(?i)authentication.*failed|credentials.*invalid|access.*denied|iam.*error",
      "cause": "Cloud provider authentication failure",
      "solution": "Check AWS_ACCESS_KEY/SECRET or cloud credentials, verify IAM permissions",
      "severity": "high",
      "category": "authentication"
    },
    {
      "id": "source_image_not_found",
      "pattern": "Source image not found",
      "regex": "(?i)source.*image.*not found|ami.*not found|base.*image.*missing",
      "cause": "The source/base image specified does not exist or is not accessible",
      "solution": "Verify source_ami/image exists in the specified region, check image sharing permissions",
      "severity": "high",
      "category": "configuration"
    },
    {
      "id": "hcl_parse_error",
      "pattern": "HCL parse error",
      "regex": "(?i)hcl.*parse|syntax error|invalid.*configuration|pkr\\.hcl.*error",
      "cause": "Syntax error in Packer HCL configuration file",
      "solution": "Run 'packer validate' to check syntax, review HCL formatting",
      "severity": "medium",
      "category": "configuration"
    },
    {
      "id": "variable_not_set",
      "pattern": "Variable not set",
      "regex": "(?i)variable.*not set|required variable|undefined variable",
      "cause": "Required variable is not defined",
      "solution": "Provide variable via -var flag, .pkrvars.hcl file, or environment variable PKR_VAR_*",
      "severity": "medium",
      "category": "configuration"
    },
    {
      "id": "post_processor_error",
      "pattern": "Post-processor error",
      "regex": "(?i)post-processor.*error|artifact.*upload.*failed|vagrant.*error",
      "cause": "Error in post-processing built image",
      "solution": "Check post-processor configuration, verify upload destinations are accessible",
      "severity": "medium",
      "category": "post_processor"
    },
    {
      "id": "timeout_exceeded",
      "pattern": "Timeout exceeded",
      "regex": "(?i)timeout.*exceeded|build.*timeout|waiting.*timeout",
      "cause": "Build operation exceeded configured timeout",
      "solution": "Increase timeout values, check if instance is starting correctly, review build logs",
      "severity": "medium",
      "category": "timing"
    }
  ],
  "related_tools": ["terraform", "ansible", "vagrant", "docker"],
  "documentation_url": "https://developer.hashicorp.com/packer/docs"
}
