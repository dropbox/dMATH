{
  "tool": "firestore",
  "category": "gcp_database",
  "description": "Google Cloud Firestore - serverless NoSQL document database",
  "common_errors": [
    {
      "id": "permission_denied",
      "pattern": "PERMISSION_DENIED",
      "regex": "(?i)permission.*denied|missing.*permission|rules.*denied|403",
      "cause": "Security rules or IAM deny access",
      "solution": "Review Firestore security rules, check IAM roles (datastore.user, datastore.viewer), verify authenticated user",
      "severity": "high",
      "category": "permissions"
    },
    {
      "id": "not_found",
      "pattern": "NOT_FOUND",
      "regex": "(?i)not.*found|document.*not.*exist|collection.*not.*found|404",
      "cause": "Document or collection does not exist",
      "solution": "Verify document path, check collection name, use exists() before reading in rules",
      "severity": "medium",
      "category": "resources"
    },
    {
      "id": "already_exists",
      "pattern": "ALREADY_EXISTS",
      "regex": "(?i)already.*exists|document.*exists|duplicate.*document",
      "cause": "Document with same ID already exists",
      "solution": "Use set() with merge option, or check existence before creating, use auto-generated IDs",
      "severity": "medium",
      "category": "resources"
    },
    {
      "id": "quota_exceeded",
      "pattern": "RESOURCE_EXHAUSTED",
      "regex": "(?i)resource.*exhausted|quota.*exceeded|rate.*limit|too.*many.*requests",
      "cause": "Firestore quota or rate limit exceeded",
      "solution": "Implement exponential backoff, batch writes, use subcollections to distribute load",
      "severity": "medium",
      "category": "limits"
    },
    {
      "id": "invalid_argument",
      "pattern": "INVALID_ARGUMENT",
      "regex": "(?i)invalid.*argument|invalid.*field|bad.*request|malformed",
      "cause": "Invalid data or query structure",
      "solution": "Verify field types match schema, check query syntax, review collection/document path format",
      "severity": "medium",
      "category": "validation"
    },
    {
      "id": "index_error",
      "pattern": "Index",
      "regex": "(?i)requires.*index|missing.*index|index.*not.*found|composite.*index",
      "cause": "Query requires a composite index that doesn't exist",
      "solution": "Create composite index in Firebase Console, or click link in error message to auto-create",
      "severity": "medium",
      "category": "indexes"
    },
    {
      "id": "transaction_error",
      "pattern": "Transaction",
      "regex": "(?i)transaction.*failed|aborted|contention|optimistic.*lock",
      "cause": "Transaction failed due to contention or timeout",
      "solution": "Retry transaction, reduce transaction scope, avoid hotspot documents, implement backoff",
      "severity": "medium",
      "category": "transactions"
    },
    {
      "id": "write_limit",
      "pattern": "Write limit",
      "regex": "(?i)write.*limit|1.*write.*per.*second|document.*rate|sustained.*write",
      "cause": "Document write rate limit exceeded (1 write/second/document)",
      "solution": "Use sharded counters for high-frequency updates, distribute writes across documents",
      "severity": "medium",
      "category": "limits"
    },
    {
      "id": "offline_error",
      "pattern": "Offline",
      "regex": "(?i)offline|network.*error|unavailable|failed.*to.*get.*document",
      "cause": "Client is offline or network unavailable",
      "solution": "Enable offline persistence, handle offline state in application, check network connectivity",
      "severity": "medium",
      "category": "connectivity"
    },
    {
      "id": "data_size",
      "pattern": "Data size",
      "regex": "(?i)document.*too.*large|1.*mb.*limit|field.*value.*too.*large|nested.*depth",
      "cause": "Document exceeds size limit (1MB) or nesting depth",
      "solution": "Store large data in Cloud Storage, flatten nested structures, use subcollections",
      "severity": "medium",
      "category": "limits"
    }
  ],
  "related_tools": ["firebase", "gcloud", "cloud_functions"],
  "documentation_url": "https://cloud.google.com/firestore/docs"
}
