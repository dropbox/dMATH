{
  "tool": "diffusers",
  "category": "ai_ml",
  "common_errors": [
    {
      "id": "diffusers_install",
      "pattern": "pip install diffusers|import error|accelerate",
      "severity": "error",
      "causes": [
        "Package not installed",
        "Missing accelerate",
        "PyTorch version"
      ],
      "solutions": [
        "Install: pip install diffusers[torch]",
        "Needs: pip install accelerate",
        "Transformers: pip install transformers"
      ]
    },
    {
      "id": "diffusers_pipeline_load",
      "pattern": "from_pretrained|pipeline load|model download",
      "severity": "error",
      "causes": [
        "Model name wrong",
        "Authentication needed",
        "Network issues"
      ],
      "solutions": [
        "pipe = DiffusionPipeline.from_pretrained('model-id')",
        "For SDXL: use StableDiffusionXLPipeline",
        "HF_TOKEN for gated models"
      ]
    },
    {
      "id": "diffusers_gpu",
      "pattern": "cuda|GPU|to device|out of memory",
      "severity": "error",
      "causes": [
        "Running on CPU",
        "GPU memory full",
        "Device mismatch"
      ],
      "solutions": [
        "pipe = pipe.to('cuda')",
        "Or: pipe.enable_model_cpu_offload()",
        "Use torch_dtype=torch.float16 to save memory"
      ]
    },
    {
      "id": "diffusers_memory_optimization",
      "pattern": "attention slicing|VAE slicing|memory efficient",
      "severity": "warning",
      "causes": [
        "High resolution images",
        "Limited GPU memory",
        "OOM errors"
      ],
      "solutions": [
        "pipe.enable_attention_slicing()",
        "pipe.enable_vae_slicing()",
        "pipe.enable_sequential_cpu_offload()"
      ]
    },
    {
      "id": "diffusers_scheduler",
      "pattern": "scheduler|sampler|num_inference_steps",
      "severity": "info",
      "causes": [
        "Changing sampling method",
        "Speed vs quality",
        "Different schedulers"
      ],
      "solutions": [
        "from diffusers import EulerDiscreteScheduler",
        "pipe.scheduler = EulerDiscreteScheduler.from_config(...)",
        "Lower steps = faster (but lower quality)"
      ]
    },
    {
      "id": "diffusers_img2img",
      "pattern": "img2img|image to image|strength",
      "severity": "info",
      "causes": [
        "Image editing",
        "Using input image",
        "Strength parameter"
      ],
      "solutions": [
        "Use StableDiffusionImg2ImgPipeline",
        "strength=0.8 (higher = more change)",
        "Input image should match model size"
      ]
    },
    {
      "id": "diffusers_controlnet",
      "pattern": "controlnet|conditioning|edge detection",
      "severity": "info",
      "causes": [
        "Guided generation",
        "Pose/edge control",
        "ControlNet setup"
      ],
      "solutions": [
        "from diffusers import ControlNetModel",
        "Use StableDiffusionControlNetPipeline",
        "Preprocess image to control format"
      ]
    },
    {
      "id": "diffusers_lora",
      "pattern": "LoRA|load_lora|fine-tune",
      "severity": "info",
      "causes": [
        "Loading LoRA weights",
        "Style adaptation",
        "Fine-tuned models"
      ],
      "solutions": [
        "pipe.load_lora_weights('lora-path')",
        "Can combine multiple LoRAs",
        "fuse_lora() for permanent merge"
      ]
    }
  ]
}
