{
  "tool": "knex",
  "category": "database_query_builder",
  "errors": [
    {
      "pattern": "ECONNREFUSED|connection refused",
      "meaning": "Cannot connect to database",
      "causes": ["Database server not running", "Wrong host/port", "Firewall blocking connection"],
      "solutions": ["Start database server", "Verify connection string", "Check firewall rules"]
    },
    {
      "pattern": "ER_ACCESS_DENIED_ERROR|authentication failed",
      "meaning": "Database authentication failed",
      "causes": ["Wrong username/password", "User doesn't have access to database", "Password expired"],
      "solutions": ["Verify credentials", "Grant user access to database", "Reset password"]
    },
    {
      "pattern": "ER_NO_SUCH_TABLE|relation.*does not exist",
      "meaning": "Table doesn't exist",
      "causes": ["Migrations not run", "Wrong table name", "Wrong database selected"],
      "solutions": ["Run npx knex migrate:latest", "Check table name spelling", "Verify database in connection string"]
    },
    {
      "pattern": "ER_BAD_FIELD_ERROR|column.*does not exist",
      "meaning": "Column doesn't exist",
      "causes": ["Migration missing column", "Typo in column name", "Column renamed/dropped"],
      "solutions": ["Check column name in schema", "Run pending migrations", "Add migration for new column"]
    },
    {
      "pattern": "ER_DUP_ENTRY|duplicate key|unique.*violation",
      "meaning": "Unique constraint violation",
      "causes": ["Inserting duplicate value", "Unique index on column", "Concurrent insert race"],
      "solutions": ["Use .onConflict().merge() for upsert", "Check existing data before insert", "Handle error gracefully"]
    },
    {
      "pattern": "Knex: Timeout acquiring a connection",
      "meaning": "Connection pool exhausted",
      "causes": ["Pool too small for load", "Connections not released", "Slow queries blocking pool"],
      "solutions": ["Increase pool.max in config", "Ensure queries are awaited", "Add connection timeout"]
    },
    {
      "pattern": "migration.*already been run",
      "meaning": "Migration already applied",
      "causes": ["Running same migration twice", "Migration file renamed", "Database out of sync"],
      "solutions": ["Check knex_migrations table", "Run migrate:status", "Use migrate:rollback if needed"]
    },
    {
      "pattern": "ER_LOCK_WAIT_TIMEOUT|lock.*timeout",
      "meaning": "Database lock timeout",
      "causes": ["Long-running transaction blocking", "Deadlock situation", "Missing index causing table scan"],
      "solutions": ["Optimize long queries", "Add appropriate indexes", "Use transactions appropriately"]
    },
    {
      "pattern": "Cannot read.*undefined.*knex",
      "meaning": "Knex not properly initialized",
      "causes": ["Knex instance not created", "Circular dependency issue", "Config not exported correctly"],
      "solutions": ["Verify knex initialization", "Export knex instance properly", "Check for circular imports"]
    }
  ]
}
