{
  "tool": "openai",
  "category": "ai_api",
  "common_errors": [
    {
      "id": "openai_v1_migration",
      "pattern": "v1 migration|openai.ChatCompletion|client",
      "severity": "error",
      "causes": [
        "Using old v0.x API",
        "Breaking changes in v1",
        "Import changes"
      ],
      "solutions": [
        "Create client: client = OpenAI()",
        "New API: client.chat.completions.create()",
        "Old: openai.ChatCompletion.create() - deprecated"
      ]
    },
    {
      "id": "openai_api_key",
      "pattern": "API key|authentication|OPENAI_API_KEY",
      "severity": "error",
      "causes": [
        "Missing API key",
        "Invalid key",
        "Key not set"
      ],
      "solutions": [
        "Set env: export OPENAI_API_KEY=sk-...",
        "Or: client = OpenAI(api_key='...')",
        "Don't commit keys to git"
      ]
    },
    {
      "id": "openai_rate_limit",
      "pattern": "rate limit|429|RateLimitError",
      "severity": "error",
      "causes": [
        "Too many requests",
        "Token limit exceeded",
        "Tier limits"
      ],
      "solutions": [
        "Implement exponential backoff",
        "Use tenacity library for retries",
        "Upgrade API tier for higher limits"
      ]
    },
    {
      "id": "openai_context_length",
      "pattern": "context length|max tokens|token limit",
      "severity": "error",
      "causes": [
        "Prompt too long",
        "Response truncated",
        "Model limit exceeded"
      ],
      "solutions": [
        "Count tokens with tiktoken",
        "Use gpt-4-turbo for 128k context",
        "Summarize or chunk long content"
      ]
    },
    {
      "id": "openai_streaming",
      "pattern": "streaming|stream|delta",
      "severity": "info",
      "causes": [
        "Real-time response",
        "Long generation",
        "Progress feedback"
      ],
      "solutions": [
        "stream=True in create()",
        "for chunk in response: chunk.choices[0].delta.content",
        "Use async: async for chunk in await ..."
      ]
    },
    {
      "id": "openai_function_calling",
      "pattern": "function calling|tools|tool_choice",
      "severity": "info",
      "causes": [
        "Structured output",
        "API integration",
        "Tool use"
      ],
      "solutions": [
        "Use tools parameter with function definitions",
        "tools=[{'type': 'function', 'function': {...}}]",
        "tool_choice='auto' or specific function"
      ]
    },
    {
      "id": "openai_json_mode",
      "pattern": "json mode|response_format|structured output",
      "severity": "info",
      "causes": [
        "Need JSON output",
        "Structured response",
        "Parsing issues"
      ],
      "solutions": [
        "response_format={'type': 'json_object'}",
        "Prompt must mention 'JSON'",
        "Use Structured Outputs for schema enforcement"
      ]
    },
    {
      "id": "openai_vision",
      "pattern": "vision|image|gpt-4-vision",
      "severity": "info",
      "causes": [
        "Processing images",
        "Image description",
        "Multimodal input"
      ],
      "solutions": [
        "Use gpt-4-turbo or gpt-4o",
        "content=[{'type': 'image_url', 'image_url': {...}}]",
        "Base64 or URL supported"
      ]
    }
  ]
}
