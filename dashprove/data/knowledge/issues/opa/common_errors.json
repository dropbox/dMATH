{
  "tool": "opa",
  "category": "policy",
  "common_errors": [
    {
      "pattern": "rego_parse_error|unexpected token",
      "meaning": "Rego syntax error",
      "causes": ["Invalid Rego syntax", "Missing import", "Wrong operator"],
      "solutions": ["Run opa check policy.rego", "Check syntax against Rego docs", "Use opa fmt to format"]
    },
    {
      "pattern": "undefined.*reference|var.*undefined",
      "meaning": "Undefined variable or reference",
      "causes": ["Typo in variable name", "Missing import", "Wrong path"],
      "solutions": ["Check variable spelling", "Add import for external data", "Verify data path exists"]
    },
    {
      "pattern": "rego_type_error|type mismatch",
      "meaning": "Type error in policy",
      "causes": ["Comparing incompatible types", "Wrong data type", "Missing type conversion"],
      "solutions": ["Use type coercion if needed", "Check data types match", "Use is_string/is_number guards"]
    },
    {
      "pattern": "decision.*undefined|result.*empty",
      "meaning": "Policy returns no decision",
      "causes": ["No rule matched", "Input data wrong format", "Default not set"],
      "solutions": ["Add default rule: default allow = false", "Check input data structure", "Test with opa eval"]
    },
    {
      "pattern": "bundle.*download.*failed|unable to load",
      "meaning": "Bundle loading error",
      "causes": ["Bundle server unreachable", "Invalid bundle format", "Auth failed"],
      "solutions": ["Check bundle server connectivity", "Verify bundle is valid: opa build", "Configure credentials"]
    },
    {
      "pattern": "conflict.*package|multiple definitions",
      "meaning": "Package/rule conflict",
      "causes": ["Same rule defined twice", "Package name collision", "Merged bundles conflict"],
      "solutions": ["Use unique rule names", "Separate into different packages", "Review bundle composition"]
    },
    {
      "pattern": "recursion.*limit|evaluation.*timeout",
      "meaning": "Policy evaluation limit reached",
      "causes": ["Infinite recursion", "Complex policy", "Large dataset"],
      "solutions": ["Review recursive rules", "Optimize policy", "Increase timeout/limit if safe"]
    },
    {
      "pattern": "data.*not found|input.*missing",
      "meaning": "Required data not available",
      "causes": ["Data not loaded", "Wrong data path", "Input not provided"],
      "solutions": ["Load data: opa run -d data.json", "Check data.* path matches file", "Provide input to evaluation"]
    },
    {
      "pattern": "decision log.*error|plugin.*failed",
      "meaning": "OPA plugin/log error",
      "causes": ["Plugin misconfigured", "Logging endpoint down", "Auth issue"],
      "solutions": ["Check plugin configuration", "Verify logging endpoint", "Review plugin credentials"]
    },
    {
      "pattern": "capability.*not allowed|built-in.*disabled",
      "meaning": "Capability restricted",
      "causes": ["Built-in function disabled", "Capability not granted", "Strict mode"],
      "solutions": ["Enable required capability", "Use --capabilities flag", "Review security restrictions"]
    }
  ],
  "debugging_commands": [
    "opa check policy.rego",
    "opa eval -d policy.rego -i input.json 'data.policy.allow'",
    "opa test -v .",
    "opa run --server -w policy.rego data.json"
  ],
  "documentation_urls": [
    "https://www.openpolicyagent.org/docs/latest/",
    "https://github.com/open-policy-agent/opa"
  ]
}
