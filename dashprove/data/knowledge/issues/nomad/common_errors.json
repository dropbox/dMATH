{
  "tool": "nomad",
  "category": "workload_orchestration",
  "description": "HashiCorp Nomad - workload orchestration and scheduling",
  "common_errors": [
    {
      "id": "allocation_failed",
      "pattern": "Allocation failed",
      "regex": "(?i)allocation.*failed|alloc.*failed|placement.*failed",
      "cause": "Job allocation could not be placed on any node",
      "solution": "Check node resources (CPU, memory), review job constraints, ensure nodes match required datacenters",
      "severity": "high",
      "category": "scheduling"
    },
    {
      "id": "task_driver_error",
      "pattern": "Task driver error",
      "regex": "(?i)driver.*error|docker.*failed|exec.*error|raw_exec.*failed",
      "cause": "Task driver (docker, exec, etc.) encountered an error",
      "solution": "Check driver is enabled on client, verify task configuration, review driver logs",
      "severity": "high",
      "category": "driver"
    },
    {
      "id": "no_nodes_available",
      "pattern": "No nodes were eligible",
      "regex": "(?i)no nodes.*eligible|no.*available.*nodes|constraint.*failed",
      "cause": "No client nodes match the job's constraints and requirements",
      "solution": "Review job constraints, check node attributes and metadata, verify datacenter configuration",
      "severity": "high",
      "category": "scheduling"
    },
    {
      "id": "artifact_download_failed",
      "pattern": "artifact download failed",
      "regex": "(?i)artifact.*download.*failed|failed to download|getter.*error",
      "cause": "Unable to download job artifacts from remote source",
      "solution": "Check artifact URL is accessible, verify network connectivity, review artifact source credentials",
      "severity": "medium",
      "category": "artifacts"
    },
    {
      "id": "vault_token_error",
      "pattern": "vault: failed to derive token",
      "regex": "(?i)vault.*token|vault.*derive|vault.*policy",
      "cause": "Unable to obtain Vault token for task",
      "solution": "Verify Vault integration is configured, check Vault policies exist for the task",
      "severity": "high",
      "category": "vault_integration"
    },
    {
      "id": "consul_service_error",
      "pattern": "consul: failed to register",
      "regex": "(?i)consul.*register|service.*registration|consul.*connect",
      "cause": "Failed to register service with Consul",
      "solution": "Check Consul integration is enabled, verify service definition in job spec",
      "severity": "medium",
      "category": "consul_integration"
    },
    {
      "id": "resource_exhausted",
      "pattern": "Resources exhausted",
      "regex": "(?i)resources exhausted|insufficient.*resources|memory.*exceeded",
      "cause": "Task exceeded allocated resources",
      "solution": "Increase task resources block (memory, cpu), review actual resource usage",
      "severity": "high",
      "category": "resources"
    },
    {
      "id": "template_error",
      "pattern": "Template error",
      "regex": "(?i)template.*error|consul-template.*failed|missing.*variable",
      "cause": "Error rendering job template (consul-template syntax)",
      "solution": "Check template syntax, verify Consul/Vault paths exist, review template variables",
      "severity": "medium",
      "category": "templates"
    },
    {
      "id": "client_disconnected",
      "pattern": "client disconnected",
      "regex": "(?i)client.*disconnected|heartbeat.*missed|node.*down",
      "cause": "Nomad client lost connection to servers",
      "solution": "Check client network connectivity, review client logs, verify server addresses",
      "severity": "high",
      "category": "cluster"
    },
    {
      "id": "job_parse_error",
      "pattern": "Job parsing error",
      "regex": "(?i)job.*parse|hcl.*error|invalid.*job.*spec",
      "cause": "Syntax error in job specification file",
      "solution": "Validate job file with 'nomad job validate', check HCL syntax",
      "severity": "medium",
      "category": "configuration"
    }
  ],
  "related_tools": ["consul", "vault", "docker", "terraform"],
  "documentation_url": "https://developer.hashicorp.com/nomad/docs"
}
