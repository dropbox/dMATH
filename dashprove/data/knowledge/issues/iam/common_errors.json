{
  "tool": "iam",
  "category": "aws_security",
  "description": "AWS Identity and Access Management - access control service",
  "common_errors": [
    {
      "id": "access_denied",
      "pattern": "AccessDenied",
      "regex": "(?i)access.*denied|not.*authorized|User:.*is not authorized|explicit.*deny",
      "cause": "IAM policy does not allow the requested action",
      "solution": "Review IAM policies attached to user/role, check for explicit deny statements, use IAM Policy Simulator",
      "severity": "high",
      "category": "permissions"
    },
    {
      "id": "malformed_policy",
      "pattern": "MalformedPolicyDocument",
      "regex": "(?i)malformed.*policy|syntax.*error|invalid.*policy|json.*parse|policy.*validation",
      "cause": "IAM policy JSON syntax or structure is invalid",
      "solution": "Validate JSON syntax, check required fields (Version, Statement), verify ARN formats, use IAM policy editor",
      "severity": "high",
      "category": "policy"
    },
    {
      "id": "entity_exists",
      "pattern": "EntityAlreadyExists",
      "regex": "(?i)entity.*already.*exists|user.*exists|role.*exists|group.*exists|duplicate",
      "cause": "IAM entity with same name already exists",
      "solution": "Use unique names, delete existing entity first, or update existing entity instead of creating",
      "severity": "medium",
      "category": "resources"
    },
    {
      "id": "limit_exceeded",
      "pattern": "LimitExceeded",
      "regex": "(?i)limit.*exceeded|quota|maximum.*policies|too.*many|cannot.*exceed",
      "cause": "IAM service quota exceeded",
      "solution": "Consolidate policies, remove unused entities, request service quota increase via AWS Support",
      "severity": "medium",
      "category": "limits"
    },
    {
      "id": "invalid_arn",
      "pattern": "InvalidArn",
      "regex": "(?i)invalid.*arn|malformed.*arn|arn.*format|resource.*not.*found",
      "cause": "ARN format is incorrect or resource doesn't exist",
      "solution": "Verify ARN format (arn:aws:service:region:account:resource), check resource exists",
      "severity": "medium",
      "category": "resources"
    },
    {
      "id": "assume_role_failed",
      "pattern": "AssumeRole",
      "regex": "(?i)unable.*to.*assume.*role|AssumeRole.*denied|trust.*policy|sts:AssumeRole",
      "cause": "Cannot assume IAM role due to trust policy",
      "solution": "Update role trust policy to allow assuming principal, check sts:AssumeRole permission on caller",
      "severity": "high",
      "category": "roles"
    },
    {
      "id": "mfa_required",
      "pattern": "MFA",
      "regex": "(?i)mfa.*required|multi.*factor|otp.*required|token.*code",
      "cause": "Action requires MFA authentication",
      "solution": "Use sts get-session-token with MFA token code, configure MFA device on IAM user",
      "severity": "high",
      "category": "authentication"
    },
    {
      "id": "delete_conflict",
      "pattern": "DeleteConflict",
      "regex": "(?i)delete.*conflict|cannot.*delete|attached.*policies|inline.*policies|access.*keys",
      "cause": "Cannot delete entity with attached resources",
      "solution": "Detach policies, delete access keys, remove from groups before deleting user/role",
      "severity": "medium",
      "category": "resources"
    },
    {
      "id": "permission_boundary",
      "pattern": "permission boundary",
      "regex": "(?i)permission.*boundary|effective.*permission|boundary.*violation",
      "cause": "Action blocked by permission boundary",
      "solution": "Review permission boundary policy, ensure requested permissions are subset of boundary",
      "severity": "high",
      "category": "permissions"
    },
    {
      "id": "credential_expired",
      "pattern": "ExpiredToken",
      "regex": "(?i)expired.*token|credential.*expired|session.*expired|security.*token.*expired",
      "cause": "AWS credentials or session token has expired",
      "solution": "Refresh credentials, use longer session duration, implement credential rotation",
      "severity": "high",
      "category": "authentication"
    }
  ],
  "related_tools": ["aws_cli", "sts", "organizations"],
  "documentation_url": "https://docs.aws.amazon.com/iam/"
}
