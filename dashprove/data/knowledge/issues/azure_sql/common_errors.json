{
  "tool": "azure_sql",
  "category": "azure_database",
  "description": "Azure SQL Database - managed relational database service",
  "common_errors": [
    {
      "id": "connection_failed",
      "pattern": "Connection failed",
      "regex": "(?i)connection.*failed|cannot.*connect|timeout|login.*failed",
      "cause": "Cannot establish connection to Azure SQL Database",
      "solution": "Check firewall rules allow client IP, verify server name (.database.windows.net), review connection string",
      "severity": "high",
      "category": "connectivity"
    },
    {
      "id": "auth_failed",
      "pattern": "Login failed",
      "regex": "(?i)login.*failed|18456|invalid.*login|authentication.*failed",
      "cause": "SQL authentication failed",
      "solution": "Verify username/password, check Azure AD authentication setup, ensure user exists in database",
      "severity": "high",
      "category": "authentication"
    },
    {
      "id": "firewall_blocked",
      "pattern": "Firewall",
      "regex": "(?i)firewall|ip.*address.*not.*allowed|40615|client.*ip.*address",
      "cause": "Firewall blocking database connection",
      "solution": "Add client IP to server firewall rules, enable 'Allow Azure services', configure VNet service endpoints",
      "severity": "high",
      "category": "networking"
    },
    {
      "id": "resource_limit",
      "pattern": "Resource limit",
      "regex": "(?i)resource.*limit|dtu.*limit|cpu.*limit|10928|resource.*governor",
      "cause": "Database resource limits (DTU/vCore) exceeded",
      "solution": "Scale up database tier, optimize queries, review resource utilization in Azure Portal",
      "severity": "high",
      "category": "performance"
    },
    {
      "id": "storage_limit",
      "pattern": "Storage limit",
      "regex": "(?i)storage.*limit|database.*full|no.*space|max.*size.*reached",
      "cause": "Database storage capacity exhausted",
      "solution": "Increase max size limit, clean up data, move to higher service tier, enable auto-growth",
      "severity": "high",
      "category": "storage"
    },
    {
      "id": "deadlock",
      "pattern": "Deadlock",
      "regex": "(?i)deadlock|1205|victim|transaction.*aborted",
      "cause": "Transaction deadlock detected",
      "solution": "Retry transaction, review query execution order, optimize indexes, use shorter transactions",
      "severity": "medium",
      "category": "transactions"
    },
    {
      "id": "permission_error",
      "pattern": "Permission",
      "regex": "(?i)permission.*denied|229|not.*have.*permission|access.*denied",
      "cause": "User lacks required database permissions",
      "solution": "Grant appropriate permissions (db_datareader, db_datawriter, etc.), add user to database role",
      "severity": "high",
      "category": "permissions"
    },
    {
      "id": "elastic_pool",
      "pattern": "Elastic pool",
      "regex": "(?i)elastic.*pool|pool.*dtu|pool.*storage|pool.*limit",
      "cause": "Elastic pool resource limits exceeded",
      "solution": "Scale elastic pool, move databases to dedicated tier, balance load across databases",
      "severity": "medium",
      "category": "capacity"
    },
    {
      "id": "geo_replication",
      "pattern": "Geo-replication",
      "regex": "(?i)geo.*replication|secondary.*database|failover|replication.*lag",
      "cause": "Geo-replication sync or failover issue",
      "solution": "Check replication state, review network connectivity to secondary region, initiate manual failover if needed",
      "severity": "high",
      "category": "replication"
    },
    {
      "id": "encryption_error",
      "pattern": "TDE",
      "regex": "(?i)tde|transparent.*data.*encryption|encryption.*key|key.*vault",
      "cause": "Transparent Data Encryption (TDE) configuration issue",
      "solution": "Verify Key Vault access, check TDE protector status, grant SQL server identity key permissions",
      "severity": "high",
      "category": "security"
    }
  ],
  "related_tools": ["azure_cli", "sqlcmd", "ssms"],
  "documentation_url": "https://docs.microsoft.com/azure/azure-sql/"
}
