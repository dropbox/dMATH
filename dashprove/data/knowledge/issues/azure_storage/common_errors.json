{
  "tool": "azure_storage",
  "category": "azure_storage",
  "description": "Azure Storage - cloud storage service (Blob, File, Queue, Table)",
  "common_errors": [
    {
      "id": "auth_error",
      "pattern": "AuthorizationFailure",
      "regex": "(?i)authorization.*failure|403|access.*denied|authentication.*failed",
      "cause": "Storage account authentication or authorization failed",
      "solution": "Check storage account key, verify SAS token, configure RBAC roles (Storage Blob Data Reader/Contributor)",
      "severity": "high",
      "category": "authentication"
    },
    {
      "id": "account_not_found",
      "pattern": "AccountNotFound",
      "regex": "(?i)account.*not.*found|storage.*account.*error|invalid.*account",
      "cause": "Storage account does not exist",
      "solution": "Verify storage account name, check subscription and resource group, create account if needed",
      "severity": "high",
      "category": "resources"
    },
    {
      "id": "container_not_found",
      "pattern": "ContainerNotFound",
      "regex": "(?i)container.*not.*found|blob.*container|404",
      "cause": "Blob container does not exist",
      "solution": "Create container, verify container name (lowercase, no special chars), check account type supports Blob",
      "severity": "medium",
      "category": "resources"
    },
    {
      "id": "blob_not_found",
      "pattern": "BlobNotFound",
      "regex": "(?i)blob.*not.*found|object.*not.*found|404",
      "cause": "Specified blob does not exist",
      "solution": "Verify blob path and name, list container contents, check if blob was deleted by lifecycle policy",
      "severity": "medium",
      "category": "resources"
    },
    {
      "id": "network_error",
      "pattern": "Network",
      "regex": "(?i)network.*error|firewall|private.*endpoint|vnet.*service.*endpoint",
      "cause": "Storage firewall blocking access",
      "solution": "Add client IP to firewall rules, configure private endpoints, enable service endpoints on VNet",
      "severity": "high",
      "category": "networking"
    },
    {
      "id": "sas_error",
      "pattern": "SAS",
      "regex": "(?i)sas.*token|signature.*not.*valid|sas.*expired|invalid.*sas",
      "cause": "SAS token invalid or expired",
      "solution": "Generate new SAS token with correct permissions and expiry, check system clock sync",
      "severity": "high",
      "category": "authentication"
    },
    {
      "id": "quota_exceeded",
      "pattern": "QuotaExceeded",
      "regex": "(?i)quota.*exceeded|storage.*limit|capacity.*limit|request.*rate",
      "cause": "Storage account quota or rate limit exceeded",
      "solution": "Increase account quota, partition data across multiple accounts, implement retry with backoff",
      "severity": "medium",
      "category": "limits"
    },
    {
      "id": "lease_error",
      "pattern": "LeaseError",
      "regex": "(?i)lease.*error|blob.*lease|lease.*id|break.*lease",
      "cause": "Blob lease conflict or missing lease ID",
      "solution": "Include lease ID in request, break existing lease, acquire lease before modification",
      "severity": "medium",
      "category": "concurrency"
    },
    {
      "id": "cors_error",
      "pattern": "CORS",
      "regex": "(?i)cors|cross.*origin|access-control|preflight",
      "cause": "CORS configuration missing or blocking request",
      "solution": "Configure CORS rules on storage account, allow required origins and methods",
      "severity": "medium",
      "category": "configuration"
    },
    {
      "id": "encryption_error",
      "pattern": "Encryption",
      "regex": "(?i)encryption.*error|customer.*key|cmk|key.*vault",
      "cause": "Customer-managed key (CMK) encryption error",
      "solution": "Verify Key Vault access policy, check key is enabled, grant storage account identity key permissions",
      "severity": "high",
      "category": "security"
    }
  ],
  "related_tools": ["azure_cli", "azcopy", "storage_explorer"],
  "documentation_url": "https://docs.microsoft.com/azure/storage/"
}
