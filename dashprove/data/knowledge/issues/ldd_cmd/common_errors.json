{
  "tool": "ldd",
  "version": "glibc",
  "last_updated": "2025-12-23",
  "errors": [
    {
      "id": "not_a_dynamic",
      "pattern": "not a dynamic executable|statically linked|not an ELF",
      "message": "File is not a dynamic executable",
      "cause": "Binary is statically linked or not an executable",
      "solutions": [
        {
          "approach": "Check file type",
          "code": "file /path/to/binary\n# Should show 'dynamically linked'",
          "when": "Verify binary type"
        },
        {
          "approach": "Static binaries",
          "code": "# Statically linked = no shared libs needed\n# ldd won't show dependencies",
          "when": "Understanding static"
        },
        {
          "approach": "Check architecture",
          "code": "file /path/to/binary\n# Ensure matches your system (x86-64, arm64, etc.)",
          "when": "Wrong architecture"
        }
      ]
    },
    {
      "id": "not_found",
      "pattern": "not found|=> not found|cannot find",
      "message": "Shared library not found",
      "cause": "Required library missing or not in library path",
      "solutions": [
        {
          "approach": "Find library",
          "code": "find /usr -name 'libfoo*'\nlocate libfoo.so",
          "when": "Locate library"
        },
        {
          "approach": "Update cache",
          "code": "sudo ldconfig\nldconfig -p | grep libfoo",
          "when": "Refresh library cache"
        },
        {
          "approach": "Add library path",
          "code": "# Temporary:\nexport LD_LIBRARY_PATH=/path/to/libs:$LD_LIBRARY_PATH\nldd binary\n\n# Permanent:\necho '/path/to/libs' | sudo tee /etc/ld.so.conf.d/custom.conf\nsudo ldconfig",
          "when": "Library in non-standard location"
        },
        {
          "approach": "Install library",
          "code": "# Debian/Ubuntu:\napt search libfoo\nsudo apt install libfoo-dev\n\n# RHEL/CentOS:\nyum provides '*/libfoo.so*'\nsudo yum install package-name",
          "when": "Missing package"
        }
      ]
    },
    {
      "id": "wrong_architecture",
      "pattern": "wrong ELF class|ELFCLASS|32.*64|architecture",
      "message": "Architecture mismatch",
      "cause": "32-bit binary on 64-bit system or vice versa",
      "solutions": [
        {
          "approach": "Check architecture",
          "code": "file binary  # Shows ELF 32-bit or 64-bit\nuname -m     # System architecture",
          "when": "Identify mismatch"
        },
        {
          "approach": "Install 32-bit libs",
          "code": "# Debian/Ubuntu:\nsudo dpkg --add-architecture i386\nsudo apt update\nsudo apt install libc6:i386\n\n# RHEL:\nsudo yum install glibc.i686",
          "when": "Run 32-bit on 64-bit"
        }
      ]
    },
    {
      "id": "security_warning",
      "pattern": "NEVER.*untrusted|security|execute",
      "message": "Security warning about ldd",
      "cause": "ldd may execute the binary",
      "solutions": [
        {
          "approach": "Safe alternative",
          "code": "objdump -p binary | grep NEEDED\nreadelf -d binary | grep NEEDED",
          "when": "Untrusted binary"
        },
        {
          "approach": "Understand risk",
          "code": "# ldd on some systems may execute the binary\n# to determine dependencies. Malicious binary\n# could run arbitrary code.\n# Use objdump/readelf for untrusted files.",
          "when": "Security awareness"
        }
      ]
    },
    {
      "id": "version_mismatch",
      "pattern": "version.*not found|GLIBC.*not found|version `",
      "message": "Library version requirement not met",
      "cause": "Binary requires newer library version",
      "solutions": [
        {
          "approach": "Check version",
          "code": "strings /lib/x86_64-linux-gnu/libc.so.6 | grep GLIBC\n# Shows available GLIBC versions",
          "when": "Check available versions"
        },
        {
          "approach": "Update system",
          "code": "sudo apt update && sudo apt upgrade",
          "when": "System too old"
        },
        {
          "approach": "Use container",
          "code": "# Run in Docker with newer glibc\ndocker run -v $PWD:/app ubuntu:latest /app/binary",
          "when": "Cannot upgrade system"
        }
      ]
    },
    {
      "id": "interpreter",
      "pattern": "interpreter|ld-linux|loader",
      "message": "Understanding the dynamic linker",
      "cause": "First line shows the linker/interpreter",
      "solutions": [
        {
          "approach": "Check interpreter",
          "code": "readelf -l binary | grep interpreter\n# Shows /lib64/ld-linux-x86-64.so.2 or similar",
          "when": "Find linker"
        },
        {
          "approach": "Use specific linker",
          "code": "/lib64/ld-linux-x86-64.so.2 --list binary",
          "when": "Alternative to ldd"
        }
      ]
    }
  ]
}
