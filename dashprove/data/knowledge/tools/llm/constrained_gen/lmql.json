{
  "id": "lmql",
  "name": "LMQL",
  "category": "llm_constrained_generation",
  "subcategory": "query_language",

  "description": "Programming language for LLM interaction with constraints",
  "long_description": "LMQL (Language Model Query Language) is a programming language for large language models that combines natural language prompting with Python-like constraints, control flow, and output validation. It enables precise control over LLM outputs through declarative constraints.",

  "capabilities": [
    "constraint_programming",
    "control_flow",
    "output_validation",
    "multi_step_prompting",
    "distribution_constraints",
    "nested_queries",
    "tool_use",
    "streaming"
  ],
  "property_types": ["constraint_satisfaction", "type_safety"],
  "input_languages": ["lmql", "python"],
  "output_formats": ["string", "json", "structured"],

  "installation": {
    "methods": [
      {"type": "pip", "command": "pip install lmql"},
      {"type": "pip_hf", "command": "pip install lmql[hf]"},
      {"type": "pip_llama", "command": "pip install lmql[llama]"}
    ],
    "dependencies": ["torch", "transformers"],
    "platforms": ["linux", "macos", "windows"]
  },

  "documentation": {
    "official": "https://lmql.ai/",
    "tutorial": "https://lmql.ai/docs/getting-started/",
    "api_reference": "https://lmql.ai/docs/language/overview.html",
    "examples": "https://lmql.ai/playground/"
  },

  "tactics": [
    {
      "name": "basic_query",
      "description": "Simple LMQL query",
      "syntax": "@lmql.query\ndef query():\n    '''lmql\n    ...\n    '''",
      "when_to_use": "For basic constrained generation",
      "examples": ["@lmql.query\ndef greet(name):\n    '''lmql\n    \"Hello [GREETING]\" where len(GREETING) < 50\n    '''\n    return GREETING"]
    },
    {
      "name": "stops",
      "description": "Stop token constraints",
      "syntax": "[VAR] where STOPS_AT(VAR, '\\n')",
      "when_to_use": "To control generation stopping",
      "examples": ["'''lmql\n\"Name: [NAME]\" where STOPS_AT(NAME, '\\n')\n'''"]
    },
    {
      "name": "type_constraint",
      "description": "Type-based constraints",
      "syntax": "[VAR: type]",
      "when_to_use": "For type-safe outputs",
      "examples": ["'''lmql\n\"Age: [AGE: int]\" where AGE > 0 and AGE < 150\n'''"]
    },
    {
      "name": "choice",
      "description": "Constrain to choices",
      "syntax": "[VAR] where VAR in ['a', 'b', 'c']",
      "when_to_use": "For classification tasks",
      "examples": ["'''lmql\n\"Sentiment: [S]\" where S in ['positive', 'negative', 'neutral']\n'''"]
    },
    {
      "name": "multi_step",
      "description": "Multi-step reasoning",
      "syntax": "for step in range(N):\n    \"[STEP]\"",
      "when_to_use": "For chain-of-thought",
      "examples": ["'''lmql\nfor i in range(3):\n    \"Step {i+1}: [REASONING]\" where STOPS_AT(REASONING, '\\n')\n\"Answer: [ANSWER]\"\n'''"]
    }
  ],

  "error_patterns": [
    {
      "pattern": "Constraint.*unsatisfiable",
      "meaning": "Impossible constraint combination",
      "common_causes": ["Contradicting constraints", "Too restrictive"],
      "fixes": ["Relax constraints", "Check logic"]
    },
    {
      "pattern": "Decoding.*timeout",
      "meaning": "Generation taking too long",
      "common_causes": ["Complex constraints", "Large output"],
      "fixes": ["Add length limits", "Simplify constraints"]
    },
    {
      "pattern": "LMQL syntax error",
      "meaning": "Invalid LMQL syntax",
      "common_causes": ["Missing quotes", "Invalid constraint syntax"],
      "fixes": ["Check LMQL syntax docs", "Use playground for debugging"]
    }
  ],

  "integration": {
    "dashprove_backend": true,
    "usl_property_types": ["constraint_satisfaction"],
    "cli_command": "dashprove verify --backend lmql"
  },

  "performance": {
    "typical_runtime": "Slightly slower than unconstrained due to constraint checking",
    "scalability": "Good",
    "memory_usage": "Moderate"
  },

  "comparisons": {
    "similar_tools": ["outlines", "guidance", "instructor"],
    "advantages": [
      "Full programming language",
      "Expressive constraints",
      "Control flow support",
      "Multi-backend support",
      "Interactive playground"
    ],
    "disadvantages": [
      "Learning curve",
      "Custom syntax",
      "Newer ecosystem"
    ]
  },

  "metadata": {
    "version": "0.7.4",
    "last_updated": "2025-12-22",
    "maintainer": "ETH Zurich SRI Lab",
    "license": "Apache-2.0"
  }
}
