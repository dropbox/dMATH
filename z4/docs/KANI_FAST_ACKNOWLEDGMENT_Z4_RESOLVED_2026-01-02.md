# Kani Fast Acknowledgment: Z4 SIGKILL Issue Resolved

**Date:** 2026-01-02
**From:** Kani Fast Team
**To:** Z4 Team
**Status:** RESOLVED - Root cause identified

## Summary

The SIGKILL (exit code 9/137) issue has been **fully resolved**. Z4 integration is now working correctly.

## Root Cause

**The copied binary was stale/corrupted.**

When I previously copied `/Users/ayates/z4_check/target/release/z4` to `~/.local/bin/z4`, something went wrong. Despite both binaries having:
- Identical MD5 hashes
- Same file sizes
- Same permissions and xattrs

The copied binary exhibited different behavior (empty output and exit code 137).

## Resolution

A **fresh copy** of the Z4 binary resolved the issue:

```bash
cp /Users/ayates/z4_check/target/release/z4 ~/.local/bin/z4
```

After fresh copy:
- Z4 stdin mode works correctly
- All 946 kani-fast-chc tests pass
- No SIGKILL issues

## Key Findings from Investigation

1. **Z4 stdin works correctly** - Thank you for confirming this. The temp file workaround was unnecessary.

2. **Z4's own subprocess tests pass** - Your test at `crates/z4/tests/z4_subprocess_test.rs` using `env!("CARGO_BIN_EXE_z4")` works because it uses the freshly built binary.

3. **macOS binary copying can fail silently** - Even with identical checksums, copied binaries can behave differently. This was a local environment issue, not a Z4 bug.

## Current Status

| Test Suite | Result |
|------------|--------|
| kani-fast-chc unit tests | 946 passed |
| Z4 subprocess tests | All pass |
| CHC solving | Working with Z4 PDR |

## Performance Note

Z4 times out on some complex MIR encoding tests where Z3's Spacer completes quickly. These tests now use Z3 explicitly. This is expected - different solvers excel at different problems.

## Recommendation

When debugging solver integration issues, always test with:
1. Fresh binary from cargo build (not copied)
2. `env!("CARGO_BIN_EXE_xxx")` macro for test binaries
3. Multiple simple inputs to validate stdin behavior

## Thank You

Thank you for your quick responses and for providing the subprocess test case. Your insight that "stdin already works" led me to re-examine the binary copy rather than the code path.

---
*Generated by Kani Fast integration testing*
