# .olean Coverage Report

**Date:** 2026-01-06
**Phase:** 0.3 .olean Verification
**Status:** COMPLETE

## Summary

| Metric | Value |
|--------|-------|
| Test Files | 18 |
| Passing | 18 |
| Coverage | 100% |

## Fixture Files

### Custom Test Modules

| File | Size | Purpose | Constants |
|------|------|---------|-----------|
| Minimal.olean | 19K | Basic defs/theorems | identity, id_id |
| Inductive.olean | 41K | Inductive types | MyBool, myTrue, myFalse, myNot |
| Structure.olean | 50K | Structures | MyPair, swap |

### Standard Library Subset

| File | Size | Purpose |
|------|------|---------|
| Init.olean | 18K | Root Init module |
| Init/Char.olean | 15K | Character handling |
| Init/Option.olean | 15K | Option type |

Total fixture size: ~158KB

## Test Categories

### Header Parsing (4 tests)

| Test | Status | Notes |
|------|--------|-------|
| Minimal header | PASS | Version = 1 |
| Inductive header | PASS | |
| Structure header | PASS | |
| Init header | PASS | |

### Module Parsing (4 tests)

| Test | Status | Notes |
|------|--------|-------|
| Minimal module | PASS | Finds identity, id_id |
| Inductive module | PASS | Finds MyBool, constructors |
| Structure module | PASS | Finds MyPair, swap |
| Init module | PASS | Has imports |

### Constant Kind Verification (5 tests)

| Test | Status | Kind Verified |
|------|--------|---------------|
| identity is Definition | PASS | Definition |
| id_id is Theorem | PASS | Theorem |
| MyBool is Inductive | PASS | Inductive |
| MyBool.myTrue is Constructor | PASS | Constructor |
| Import verification | PASS | Has Init imports |

### Error Handling (3 tests)

| Test | Status | Notes |
|------|--------|-------|
| Invalid header rejected | PASS | Non-olean data |
| Empty bytes rejected | PASS | Zero-length input |
| Truncated header rejected | PASS | < 56 bytes |

### Consistency Tests (2 tests)

| Test | Status | Notes |
|------|--------|-------|
| Same Lean version | PASS | All custom fixtures match |
| Load into env | PASS | Module has constants |

## .olean Format Coverage

### Header Fields (56 bytes)

| Field | Offset | Size | Status |
|-------|--------|------|--------|
| Magic "olean" | 0 | 5 | PASS |
| Version | 5 | 1 | PASS |
| Git hash | 6 | 42 | PASS |
| Base address | 48 | 8 | PASS |

### Constant Kinds Tested

| Kind | Value | Tested |
|------|-------|--------|
| Axiom | 0 | - |
| Definition | 1 | YES |
| Theorem | 2 | YES |
| Opaque | 3 | - |
| Quot | 4 | - |
| Inductive | 5 | YES |
| Constructor | 6 | YES |
| Recursor | 7 | - |

### Module Components

| Component | Status |
|-----------|--------|
| Imports list | PASS |
| Constant names | PASS |
| Constant definitions | PASS |
| Universe levels | PASS |
| Expressions | PASS |

## Lean Version Compatibility

Fixtures compiled with:
- Lean 4.13.0
- Commit: 6d22e0e5cc5a
- .olean format version: 1

## Test Location

Tests: `crates/lean5-olean/tests/fixtures.rs`
Fixtures: `tests/fixtures/olean/v4.13.0/`

Run with:
```bash
cargo test -p lean5-olean --test fixtures
```

## Offline Testing Benefits

These fixtures enable:
1. **CI without Lean** - No Lean 4 installation required
2. **Fast tests** - No file system search for stdlib
3. **Version pinning** - Consistent format across environments
4. **Regression detection** - Known-good .olean parsing

## Known Limitations

1. **No dependency chain** - Fixtures don't include full Init dependency tree
2. **No large files** - Prelude.olean (3.2MB) excluded due to size
3. **Single version** - Only v4.13.0 fixtures included

## Future Extensions

1. Add more constant kinds (Axiom, Opaque, Recursor)
2. Add fixtures for different Lean versions
3. Add expression-level parsing tests
4. Add round-trip (export) tests

---

*Generated by Phase 0.3 .olean Verification*
